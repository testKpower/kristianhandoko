<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>TOTP List - Dark UI</title>
<style>
  body {
    background-color: #121212;
    color: #fff;
    font-family: Arial, sans-serif;
    margin: 0;
    padding: 0;
  }
  header {
    padding: 1rem;
    text-align: center;
    background: #1f1f1f;
    position: sticky;
    top: 0;
    z-index: 100;
  }
  header input {
    padding: 0.5rem;
    border-radius: 5px;
    border: none;
    width: 250px;
    background: #2a2a2a;
    color: white;
  }
  .container {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
    gap: 1rem;
    padding: 1rem;
  }
  .card {
    background: #1e1e1e;
    border-radius: 12px;
    padding: 1rem;
    display: flex;
    flex-direction: column;
    gap: 0.5rem;
    transition: transform 0.2s, box-shadow 0.2s;
  }
  .card:hover {
    transform: translateY(-4px);
    box-shadow: 0 4px 15px rgba(0,0,0,0.4);
  }
  .otp {
    font-size: 2rem;
    font-weight: bold;
    letter-spacing: 2px;
  }
  .meta {
    font-size: 0.9rem;
    color: #bbb;
  }
  .issuer {
    font-size: 1.1rem;
    font-weight: bold;
    color: #fff;
  }
  .account {
    font-size: 0.9rem;
    color: #888;
  }
  .progress {
    height: 5px;
    background: #333;
    border-radius: 3px;
    overflow: hidden;
  }
  .progress-bar {
    height: 100%;
    background: linear-gradient(90deg, #4cafef, #2196f3);
    transition: width 1s linear;
  }
  .copy-btn {
    margin-top: 0.5rem;
    padding: 0.4rem 0.6rem;
    background: #2196f3;
    color: white;
    border: none;
    border-radius: 6px;
    cursor: pointer;
    transition: background 0.2s;
  }
  .copy-btn:hover {
    background: #1976d2;
  }
</style>
</head>
<body>

<header>
  <input type="text" id="search" placeholder="Search issuer/account...">
</header>

<div class="container" id="totpList"></div>

<script src="https://cdnjs.cloudflare.com/ajax/libs/jsSHA/3.2.0/sha.js"></script>
<script>
  // ====== PASSWORD PROTECTION ======
  const correctPassword = "150123"; // ubah sesuai kebutuhan
  let pass = prompt("Masukkan password:");
  if (pass !== correctPassword) {
    document.body.innerHTML = "<h1 style='color:white;text-align:center;margin-top:50px;'>Password salah!</h1>";
    throw new Error("Password salah");
  }

  // ====== STATIC SECRET LIST ======
const secrets = [
      { secret: "RDKE6NFSB37FAS74FBTDPNF4U42XWE6D", issuer: "AWS Secret", account: "techfe-kristian" },
      { secret: "odgluctjssjfleh46pp3xio7xzrnijmp", issuer: "Google", account: "kristian.wijaya@ruparupa.com" },
      { secret: "WO55TYAVBCTCXOEEUQC3JTNQGISB6UJK", issuer: "Gideon Production", account: "kristian@ruparupa.com" },
      { secret: "TP3FOJWMTWH67GK4AYTAP7JLHFCTMRX2", issuer: "OMS Production", account: "kristian2@ruparupa.com" },
      { secret: "6YQGJWWV3HFCKNWQBSEHHJOPOVKARNLK", issuer: "Postmark", account: "kristian.wijaya@ruparupa.com" },
      { secret: "USA7GDAAHIVOVHOI6R7BHC6T2CNFW6O6", issuer: "ruparupa-production", account: "kristian@new-teleport.rupasecops.com" },
      { secret: "NNHGU3KSMNLGSRRXM47SWSK5GRGHOXD2", issuer: "Atlassian", account: "kristian.wijaya@ruparupa.com" },
      { secret: "NO2XLVSJRXHI65NRVBPCBHRU3KW5FJQS", issuer: "Cloudinary", account: "kristian.wijaya@ruparupa.com" },
      { secret: "aok7hpa4cmjilpx54q5eblxa752ziy7l", issuer: "Google", account: "tech.ruparupa@gmail.com" },
      { secret: "2VRB3BAYAQTSWKPF7QMAP3GRE4FEXK5V", issuer: "ruparupa-production", account: "kristian@teleport.rupasecops.com" },
      { secret: "CXYV5YELRVBXVZTH3RG66MSYYQ5NUVH7", issuer: "OpenAI", account: "admin@ruparupa.com" },
      { secret: "IN3GWMKLGBWDA4JB", issuer: "Tokocrypto", account: "kristian.handoko@yahoo.co.id" },
      { secret: "7CKLI255TE7UNHB4BE3FSYLMULVCLOTD", issuer: "hub.docker.com", account: "testkpower" },
    ];
    
  const period = 30;

  function base32toHex(base32) {
    const base32chars = "ABCDEFGHIJKLMNOPQRSTUVWXYZ234567";
    let bits = "";
    let hex = "";
    base32 = base32.replace(/=+$/, "");
    for (let i = 0; i < base32.length; i++) {
      let val = base32chars.indexOf(base32.charAt(i).toUpperCase());
      bits += val.toString(2).padStart(5, "0");
    }
    for (let i = 0; i + 4 <= bits.length; i += 4) {
      let chunk = bits.substr(i, 4);
      hex += parseInt(chunk, 2).toString(16);
    }
    return hex;
  }

  function generateTOTP(secret) {
    const epoch = Math.floor(Date.now() / 1000);
    const time = Math.floor(epoch / period);
    const timeHex = time.toString(16).padStart(16, "0");
    const key = base32toHex(secret);
    const shaObj = new jsSHA("SHA-1", "HEX");
    shaObj.setHMACKey(key, "HEX");
    shaObj.update(timeHex);
    const hmac = shaObj.getHMAC("HEX");
    const offset = parseInt(hmac.substring(hmac.length - 1), 16);
    const otp = (parseInt(hmac.substr(offset * 2, 8), 16) & 0x7fffffff) + "";
    return otp.substr(otp.length - 6);
  }

  function renderList() {
    const listContainer = document.getElementById("totpList");
    const searchVal = document.getElementById("search").value.toLowerCase();
    listContainer.innerHTML = "";
    secrets.forEach(item => {
      if (
        item.issuer.toLowerCase().includes(searchVal) ||
        item.account.toLowerCase().includes(searchVal)
      ) {
        const otp = generateTOTP(item.secret);
        const remain = period - (Math.floor(Date.now() / 1000) % period);
        const card = document.createElement("div");
        card.className = "card";
        card.innerHTML = `
          <div class="issuer">${item.issuer}</div>
          <div class="account">${item.account}</div>
          <div class="otp">${otp}</div>
          <div class="progress"><div class="progress-bar" style="width:${(1 - remain / period) * 100}%"></div></div>
          <button class="copy-btn">Copy</button>
        `;
        card.querySelector(".copy-btn").onclick = () => {
          navigator.clipboard.writeText(otp);
          card.style.boxShadow = "0 0 10px #4cafef";
          setTimeout(() => card.style.boxShadow = "", 500);
        };
        listContainer.appendChild(card);
      }
    });
  }

  setInterval(renderList, 1000);
  document.getElementById("search").addEventListener("input", renderList);
  renderList();
</script>

</body>
</html>
